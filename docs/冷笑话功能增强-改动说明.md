# Punchliner 冷笑话功能增强 - 改动说明

## 一、需求回顾

### 原有功能
- 今日笑一笑：每日段子，缓存一天，换一个按钮
- 更多段子列表：分页加载

### 新增功能
1. **今日冷笑话** - 放在首页最上方
   - 每日一条，缓存一天
   - 换一个按钮（换冷笑话）
   - 暗调风格（深色背景 + 橙色主题）

2. **冷笑话列表** - 批量生成
   - 每次生成10条（可配置）
   - 卡片式展示，与段子列表类似
   - 点击进入详情页

3. **冷笑话详情页**
   - 路径：`/cold-joke/[id]`
   - 支持生成配图（暗调风格：黑底 + 橙色文字）
   - 收藏功能

4. **AI生成** - 智谱AI
   - 冷笑话内容生成
   - 配图生成

5. **布局调整**
   - 今日冷笑话（最上）
   - 今日笑一笑
   - 更多冷笑话列表
   - 更多段子列表

---

## 二、文件改动清单

### 新增文件

| 文件路径 | 说明 |
|---------|------|
| `src/app/api/jokes/cold/route.ts` | 每日冷笑话API |
| `src/app/api/jokes/cold/list/route.ts` | 冷笑话列表API |
| `src/app/cold-joke/[id]/page.tsx` | 冷笑话详情页 |
| `src/app/cold-joke/[id]/page.module.css` | 详情页样式 |

### 修改文件

| 文件路径 | 改动内容 |
|---------|---------|
| `src/app/page.tsx` | 添加冷笑话区块，调整布局顺序 |
| `src/app/page.module.css` | 添加冷笑话样式（暗调风格） |
| `src/app/api/ai/image/route.ts` | 支持冷笑话风格图片生成 |
| `src/lib/ai.ts` | 添加 coldImage prompt |
| `src/types/index.ts` | 添加 coldImage 类型 |

---

## 三、样式规范

### 冷笑话卡片 - 暗调风格

```css
/* 背景 */
background: linear-gradient(145deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);

/* 主题色 */
color: #ffa500; /* 橙色 */
border: 1px solid rgba(255, 165, 0, 0.15);

/* 装饰元素 */
❄️ 雪花动画效果
```

### 图片生成 Prompt

```
请为以下冷笑话生成一张图片描述，要求：
1. 黑色背景 (#000000)
2. 文字颜色使用橙色 (#FFA500) 或黄色 (#FFD700)
3. 简约文字卡片风格
4. 文字内容要突出幽默感
5. 描述不要超过60字
```

---

## 四、API 接口

### 1. 每日冷笑话
```
GET /api/jokes/cold
Response: { code: 1, data: [{ id, content, updateTime }] }
```

### 2. 冷笑话列表
```
GET /api/jokes/cold/list?page=1
Response: { code: 1, data: { list: [...], page, totalPage } }
```

### 3. 生成配图
```
POST /api/ai/image
Body: { content: "冷笑话内容", style: "cold" }
Response: { code: 1, data: { url: "图片URL" } }
```

---

## 五、页面结构

```
首页 /
├── 今日冷笑话 ❄️（暗调卡片）
│   ├── 内容
│   └── 换一个按钮
├── 今日笑一笑 ✨（亮调卡片）
│   ├── 内容
│   └── 换一个按钮
├── 更多冷笑话 🥶
│   └── 卡片列表（可加载更多）
└── 更多段子 🎭
    └── 卡片列表（可加载更多）

冷笑话详情页 /cold-joke/[id]
├── 内容展示
├── 生成配图按钮
└── 收藏按钮
```

---

## 六、待确认项

- [ ] 冷笑话列表默认生成10条是否足够？
- [ ] 暗调风格的颜色是否需要调整？
- [ ] 雪花装饰是否需要更换？
- [ ] 详情页是否需要添加其他功能（如分享、复制）？

---

## 七、测试要点

1. 每日冷笑话缓存是否正常（第二天自动刷新）
2. 换一个按钮是否能正常切换
3. 冷笑话列表加载是否正常
4. 详情页配图生成是否正确（黑底橙色文字）
5. 布局在移动端的显示效果
